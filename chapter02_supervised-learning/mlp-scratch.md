# 多层感知机 --- 从0开始

前面我们介绍了包括线性回归和多类逻辑回归的数个模型，它们的一个共同点是全是只含有一个输入层，一个输出层。这一节我们将介绍多层神经网络，就是包含至少一个隐含层的网络。

## 数据获取

我们继续使用FashionMNIST数据集。

```{.python .input  n=5}
import sys
sys.path.append('..')
import utils
# utils??
batch_size = 256
train_data, test_data = utils.load_data_fashion_mnist(batch_size)
```

```{.python .input  n=3}
train_data
```

```{.json .output n=3}
[
 {
  "data": {
   "text/plain": "<mxnet.gluon.data.dataloader.DataLoader at 0x7f53f94e7198>"
  },
  "execution_count": 3,
  "metadata": {},
  "output_type": "execute_result"
 }
]
```

## 多层感知机

多层感知机与前面介绍的[多类逻辑回归](../chapter01_crashcourse/softmax-regression-scratch.md)非常类似，主要的区别是我们在输入层和输出层之间插入了一到多个隐含层。

![](../img/multilayer-perceptron.png)

这里我们定义一个只有一个隐含层的模型，这个隐含层输出256个节点。

```{.python .input  n=6}
from mxnet import ndarray as nd

num_inputs = 28*28
num_outputs = 10

num_hidden = 256
weight_scale = .01

W1 = nd.random_normal(shape=(num_inputs, num_hidden), scale=weight_scale)
b1 = nd.zeros(num_hidden)

W2 = nd.random_normal(shape=(num_hidden, num_outputs), scale=weight_scale)
b2 = nd.zeros(num_outputs)

params = [W1, b1, W2, b2]
print(params)
for param in params:
    param.attach_grad()
```

```{.json .output n=6}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "[\n[[ 0.02212206  0.01163079  0.00774004 ...,  0.01464221 -0.02246507\n  -0.01305814]\n [-0.00343046  0.0093444  -0.00407202 ...,  0.0021739  -0.00332779\n   0.00991878]\n [-0.00483628  0.00272165 -0.00921403 ...,  0.01106624 -0.00173846\n   0.00506085]\n ..., \n [-0.0041335   0.01444468 -0.00034786 ..., -0.00818633  0.00328797\n  -0.01651064]\n [-0.01083938  0.01456489  0.00415813 ...,  0.01116188 -0.00359927\n  -0.01636656]\n [ 0.00474886 -0.01382229  0.00422195 ...,  0.00013463  0.00146803\n  -0.00412278]]\n<NDArray 784x256 @cpu(0)>, \n[ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.\n  0.  0.  0.  0.]\n<NDArray 256 @cpu(0)>, \n[[-0.00784416 -0.0013876   0.01501241 ...,  0.00589934  0.01228907\n  -0.00422185]\n [ 0.00305312  0.01151531  0.0077865  ...,  0.00031234  0.01228901\n   0.0040109 ]\n [ 0.00907922  0.00521923  0.01729963 ...,  0.01785822 -0.00376513\n   0.00350809]\n ..., \n [ 0.01450905  0.01096348 -0.00412862 ..., -0.01593751 -0.01172956\n  -0.01420189]\n [ 0.00204178 -0.0043916  -0.00016609 ...,  0.0071008   0.01608049\n   0.00261518]\n [ 0.00550891 -0.01151449 -0.00659712 ...,  0.01442856 -0.00380088\n  -0.02075295]]\n<NDArray 256x10 @cpu(0)>, \n[ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]\n<NDArray 10 @cpu(0)>]\n"
 }
]
```

## 激活函数

如果我们就用线性操作符来构造多层神经网络，那么整个模型仍然只是一个线性函数。这是因为

$$\hat{y} = X \cdot W_1 \cdot W_2 = X \cdot W_3 $$

这里$W_3 = W_1 \cdot W_2$。为了让我们的模型可以拟合非线性函数，我们需要在层之间插入非线性的激活函数。这里我们使用ReLU

$$\textrm{rel}u(x)=\max(x, 0)$$

```{.python .input  n=18}
def relu(X):
    print('relu X.shape', X.shape)
    return nd.maximum(X, 0)
```

## 定义模型

我们的模型就是将层（全连接）和激活函数（Relu）串起来：

```{.python .input  n=19}
def net(X):
    print('net X.shape', X.shape)
    X = X.reshape((-1, num_inputs))
    h1 = relu(nd.dot(X, W1) + b1)
    output = nd.dot(h1, W2) + b2
    return output
```

## Softmax和交叉熵损失函数

在多类Logistic回归里我们提到分开实现Softmax和交叉熵损失函数可能导致数值不稳定。这里我们直接使用Gluon提供的函数

```{.python .input  n=20}
from mxnet import gluon
softmax_cross_entropy = gluon.loss.SoftmaxCrossEntropyLoss()
```

## 训练

训练跟之前一样。

```{.python .input  n=21}
from mxnet import autograd as autograd

learning_rate = .5

for epoch in range(5):
    train_loss = 0.
    train_acc = 0.
    for data, label in train_data:
        with autograd.record():
            output = net(data)
            loss = softmax_cross_entropy(output, label)
        loss.backward()
        utils.SGD(params, learning_rate/batch_size)

        train_loss += nd.mean(loss).asscalar()
        train_acc += utils.accuracy(output, label)

    test_acc = utils.evaluate_accuracy(test_data, net)
    print("Epoch %d. Loss: %f, Train acc %f, Test acc %f" % (
        epoch, train_loss/len(train_data), 
        train_acc/len(train_data), test_acc))
```

```{.json .output n=21}
[
 {
  "name": "stdout",
  "output_type": "stream",
  "text": "net X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (96, 1, 28, 28)\nrelu X.shape (96, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (16, 1, 28, 28)\nrelu X.shape (16, 256)\nEpoch 0. Loss: 0.479187, Train acc 0.823471, Test acc 0.850684\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (96, 1, 28, 28)\nrelu X.shape (96, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (16, 1, 28, 28)\nrelu X.shape (16, 256)\nEpoch 1. Loss: 0.419705, Train acc 0.845224, Test acc 0.845996\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\nnet X.shape (256, 1, 28, 28)\nrelu X.shape (256, 256)\n"
 },
 {
  "ename": "KeyboardInterrupt",
  "evalue": "",
  "output_type": "error",
  "traceback": [
   "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
   "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
   "\u001b[0;32m<ipython-input-21-212cf9989484>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      6\u001b[0m     \u001b[0mtrain_loss\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m0.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      7\u001b[0m     \u001b[0mtrain_acc\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m0.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 8\u001b[0;31m     \u001b[0;32mfor\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabel\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mtrain_data\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      9\u001b[0m         \u001b[0;32mwith\u001b[0m \u001b[0mautograd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrecord\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     10\u001b[0m             \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnet\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;32m~/miniconda3/envs/gluon/lib/python3.6/site-packages/mxnet/gluon/data/dataloader.py\u001b[0m in \u001b[0;36m__iter__\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m     90\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__iter__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     91\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mbatch\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_batch_sampler\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 92\u001b[0;31m             \u001b[0;32myield\u001b[0m \u001b[0m_batchify\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_dataset\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0midx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mbatch\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     93\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     94\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__len__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;32m~/miniconda3/envs/gluon/lib/python3.6/site-packages/mxnet/gluon/data/dataloader.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m     90\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__iter__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     91\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mbatch\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_batch_sampler\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 92\u001b[0;31m             \u001b[0;32myield\u001b[0m \u001b[0m_batchify\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_dataset\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0midx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mbatch\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     93\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     94\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__len__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;32m~/miniconda3/envs/gluon/lib/python3.6/site-packages/mxnet/gluon/data/vision.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, idx)\u001b[0m\n\u001b[1;32m     47\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__getitem__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0midx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     48\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_transform\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 49\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_transform\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_data\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_label\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     50\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_data\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_label\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0midx\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     51\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;32m~/gluon-tutorials-zh/utils.py\u001b[0m in \u001b[0;36mtransform_mnist\u001b[0;34m(data, label)\u001b[0m\n\u001b[1;32m     19\u001b[0m \u001b[0;32mdef\u001b[0m \u001b[0mtransform_mnist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabel\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     20\u001b[0m     \u001b[0;31m# change data from height x weight x channel to channel x height x weight\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 21\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0mnd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtranspose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'float32'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m/\u001b[0m\u001b[0;36m255\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlabel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'float32'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     22\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     23\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;32m~/miniconda3/envs/gluon/lib/python3.6/site-packages/mxnet/ndarray/ndarray.py\u001b[0m in \u001b[0;36m__truediv__\u001b[0;34m(self, other)\u001b[0m\n\u001b[1;32m    247\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    248\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__truediv__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mother\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 249\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mdivide\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mother\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    250\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    251\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__rtruediv__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mother\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;32m~/miniconda3/envs/gluon/lib/python3.6/site-packages/mxnet/ndarray/ndarray.py\u001b[0m in \u001b[0;36mdivide\u001b[0;34m(lhs, rhs)\u001b[0m\n\u001b[1;32m   1972\u001b[0m         \u001b[0moperator\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtruediv\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1973\u001b[0m         \u001b[0m_internal\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_div_scalar\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1974\u001b[0;31m         _internal._rdiv_scalar)\n\u001b[0m\u001b[1;32m   1975\u001b[0m     \u001b[0;31m# pylint: enable= no-member, protected-access\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1976\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;32m~/miniconda3/envs/gluon/lib/python3.6/site-packages/mxnet/ndarray/ndarray.py\u001b[0m in \u001b[0;36m_ufunc_helper\u001b[0;34m(lhs, rhs, fn_array, fn_scalar, lfn_scalar, rfn_scalar)\u001b[0m\n\u001b[1;32m   1726\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mrfn_scalar\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrhs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfloat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlhs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1727\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrhs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnumeric_types\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1728\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mlfn_scalar\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlhs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfloat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrhs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1729\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrhs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mNDArray\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1730\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mfn_array\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlhs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrhs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;32m~/miniconda3/envs/gluon/lib/python3.6/site-packages/mxnet/ndarray/op.py\u001b[0m in \u001b[0;36m_div_scalar\u001b[0;34m(data, scalar, out, name, **kwargs)\u001b[0m\n",
   "\u001b[0;32m~/miniconda3/envs/gluon/lib/python3.6/site-packages/mxnet/_ctypes/ndarray.py\u001b[0m in \u001b[0;36m_imperative_invoke\u001b[0;34m(handle, ndargs, keys, vals, out)\u001b[0m\n\u001b[1;32m     90\u001b[0m         \u001b[0mc_array\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mctypes\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mc_char_p\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mc_str\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mkey\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mkeys\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     91\u001b[0m         \u001b[0mc_array\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mctypes\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mc_char_p\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mc_str\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mval\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mval\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mvals\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 92\u001b[0;31m         ctypes.byref(out_stypes)))\n\u001b[0m\u001b[1;32m     93\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     94\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0moriginal_output\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
   "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
  ]
 }
]
```

## 总结

可以看到，加入一个隐含层后我们将精度提升了不少。

## 练习

- 我们使用了 `weight_scale` 来控制权重的初始化值大小，增大或者变小这个值会怎么样？
- 尝试改变 `num_hiddens` 来控制模型的复杂度
- 尝试加入一个新的隐含层

**吐槽和讨论欢迎点**[这里](https://discuss.gluon.ai/t/topic/739)
